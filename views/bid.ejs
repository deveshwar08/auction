<%- include('./partials/header.ejs') %>
    <div>
        <h1>Bid Id : <%- bidDetails._id %> </h1>
        <h3>Auctioner : <%- bidDetails.auctioner %> </h3>
        <h3>Base Bid : <%- bidDetails.baseBid %> </h3>
        <h3>Item Name : <%- bidDetails.itemName %> </h3>
        <% if(bidDetails.highestBidder && bidDetails.bidAmount){ %>
            <h3>Highest Bidder : <%- bidDetails.highestBidder %> </h3>
            <h3>Current Bid : <%- bidDetails.bidAmount %> </h3>
        <% }else{ %>
            <h5>No Bids till now</h5>
        <% } %>
    </div>
    <% const url = '"/bid/'+bidDetails._id+'/"' %> 
    <form>
        <label for="amount">Bid Amount</label>
        <input type="number" name="amount">
        <div class="error"></div>
        <button type="submit">Bid</button>
    </form>
    <div class="success"></div>
    <script>
        const form = document.querySelector('form');
        form.addEventListener('submit',async (e) =>{
    

            e.preventDefault();
            const amount =  form.amount.value;
            try{
                const res = await fetch(window.location.pathname,{
                    method: 'POST',                    
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({amount}),
                });
                const data = await res.json();
                console.log(data);
                if(data){
                    document.querySelector('.success').textContent = "Bidded Successfully";
                    location.assign(window.location);
                }
            }
            catch (err){
                document.querySelector('.error').textContent = err;
            }
        });
    </script>
<%- include('./partials/footer.ejs')%> 